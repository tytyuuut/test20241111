"use strict";(self["webpackChunkvue3_cart"]=self["webpackChunkvue3_cart"]||[]).push([[611],{6611:function(t,e,s){s.r(e),s.d(e,{default:function(){return T}});var a=s(6768),o=s(4232),l=s(5130),c=s(5432);const d={class:"container",style:{height:"100vh","padding-top":"100px"}},i={class:"mt-3"},r={class:"row"},n={class:"col-md-8"},u={class:"table"},p={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},h=["src"],b={class:"mb-0 fw-bold ms-3 d-inline-block"},k={key:0,class:"text-success"},m={class:"border-0 align-middle",style:{"max-width":"160px"}},g={class:"input-group pe-5"},L={class:"input-group-prepend"},f=["onClick","disabled"],y=["onUpdate:modelValue"],v={class:"input-group-append"},C=["onClick","disabled"],x={class:"border-0 align-middle"},w={key:0,class:"text-success"},$=["onClick"],_={class:"input-group w-50 mb-3"},I={class:"input-group-append"},q={class:"col-md-4"},S={class:"border p-4 mb-4"},E={class:"d-flex justify-content-between mt-4"},M={class:"mb-0 h4 fw-bold"},X={key:0,class:"justify-content-between mt-4 d-flex"},A={class:"text-end text-success"};function U(t,e,s,U,j,F){const N=(0,a.g2)("userLoading");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(N,{active:t.isLoading},{default:(0,a.k6)((()=>e[2]||(e[2]=[(0,a.Lk)("div",{class:"loading-bg"},[(0,a.Lk)("img",{src:c,alt:"loading"})],-1)]))),_:1},8,["active"]),(0,a.Lk)("div",d,[(0,a.Lk)("div",i,[(0,a.Lk)("div",r,[(0,a.Lk)("div",n,[(0,a.Lk)("table",u,[e[6]||(e[6]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{scope:"col",class:"border-0"},"產品名稱"),(0,a.Lk)("th",{scope:"col",class:"border-0"},"產品數量"),(0,a.Lk)("th",{scope:"col",class:"border-0"},"產品價錢")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(j.cart.carts,(s=>((0,a.uX)(),(0,a.CE)("tr",{class:"border-bottom border-top",key:s.id},[(0,a.Lk)("th",p,[(0,a.Lk)("img",{src:s.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,h),(0,a.Lk)("p",b,(0,o.v_)(s.product.title),1),s.coupon?((0,a.uX)(),(0,a.CE)("small",k,"已套用優惠券")):(0,a.Q3)("",!0)]),(0,a.Lk)("td",m,[(0,a.Lk)("div",g,[(0,a.Lk)("div",L,[(0,a.Lk)("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",onClick:t=>F.handleSub(s),disabled:s.id===j.status.loadingItem},e[3]||(e[3]=[(0,a.Lk)("i",{class:"fas fa-minus"},null,-1)]),8,f)]),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none","onUpdate:modelValue":t=>s.qty=t,readonly:""},null,8,y),[[l.Jo,s.qty,void 0,{number:!0}]]),(0,a.Lk)("div",v,[(0,a.Lk)("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",onClick:t=>F.handlePlus(s),disabled:s.id===j.status.loadingItem},e[4]||(e[4]=[(0,a.Lk)("i",{class:"fas fa-plus"},null,-1)]),8,C)])])]),(0,a.Lk)("td",x,[j.cart.final_total!==j.cart.total?((0,a.uX)(),(0,a.CE)("small",w,"折扣價")):(0,a.Q3)("",!0),(0,a.eW)(" NT$"+(0,o.v_)(t.$filters.currency(s.final_total)),1)]),(0,a.Lk)("td",{class:"border-0 align-middle",onClick:t=>F.removeCart(s.id)},e[5]||(e[5]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]),8,$)])))),128))])]),(0,a.Lk)("div",_,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none","onUpdate:modelValue":e[0]||(e[0]=t=>j.coupon_code=t),placeholder:"請輸入優惠碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[l.Jo,j.coupon_code]]),(0,a.Lk)("div",I,[(0,a.Lk)("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",onClick:e[1]||(e[1]=t=>F.addCouponCode())},e[7]||(e[7]=[(0,a.Lk)("i",{class:"fas fa-paper-plane"},null,-1),(0,a.eW)(" 套用優惠碼")]))])])]),(0,a.Lk)("div",q,[(0,a.Lk)("div",S,[e[10]||(e[10]=(0,a.Lk)("h4",{class:"fw-bold mb-4"},"訂單總價",-1)),e[11]||(e[11]=(0,a.Lk)("table",{class:"table text-muted border-bottom"},[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"付款方式"),(0,a.Lk)("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"現金付款")])])],-1)),(0,a.Lk)("div",E,[e[8]||(e[8]=(0,a.Lk)("p",{class:"mb-0 h4 fw-bold"},"總價",-1)),(0,a.Lk)("p",M,"NT$"+(0,o.v_)(t.$filters.currency(j.cart.total)),1)]),j.cart.final_total!==j.cart.total?((0,a.uX)(),(0,a.CE)("div",X,[e[9]||(e[9]=(0,a.Lk)("p",{class:"mb-0 h4 fw-bold text-success"},"折扣價",-1)),(0,a.Lk)("p",A,"NT$"+(0,o.v_)(t.$filters.currency(j.cart.final_total)),1)])):(0,a.Q3)("",!0),e[12]||(e[12]=(0,a.Lk)("a",{href:"./#/checkout",class:"btn btn-dark w-100 mt-4"},"確認送出",-1))])])])])])],64)}var j=s(1600),F={name:"UserCart",data(){return{cart:{},coupon_code:"",status:{loadingItem:""}}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/andy1234-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1})).catch((t=>{console.error("獲取購物車失敗:",t)}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/andy1234-api/coupon",e={code:this.coupon_code};this.$http.post(t,{data:e}).then((t=>{this.$httpMessageState(t,"套用優惠碼"),this.getCart(),j.A.emit("update-cart")})).catch((t=>{console.error("套用優惠碼失敗:",t),this.$httpMessageState({success:!1},"套用優惠碼失敗")}))},removeCart(t){const e=`https://vue3-course-api.hexschool.io/api/andy1234-api/cart/${t}`;this.status.loadingItem=t,this.$http.delete(e).then((t=>{this.$httpMessageState(t,"移除購物車"),this.status.loadingItem="",this.getCart(),j.A.emit("update-cart")})).catch((t=>{console.error("移除購物車失敗:",t),this.status.loadingItem="",this.$httpMessageState({success:!1},"移除購物車失敗")}))},handlePlus(t){t.qty++;const e=`https://vue3-course-api.hexschool.io/api/andy1234-api/cart/${t.id}`;this.status.loadingItem=t.id;const s={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:s}).then((t=>{this.status.loadingItem="",this.getCart(),j.A.emit("update-cart")})).catch((t=>{console.error("更新數量失敗:",t),this.status.loadingItem="",this.$httpMessageState({success:!1},"更新數量失敗")}))},handleSub(t){if(t.qty>1){t.qty--;const e=`https://vue3-course-api.hexschool.io/api/andy1234-api/cart/${t.id}`;this.status.loadingItem=t.id;const s={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:s}).then((t=>{this.status.loadingItem="",this.getCart(),j.A.emit("update-cart")})).catch((t=>{console.error("更新數量失敗:",t),this.status.loadingItem="",this.$httpMessageState({success:!1},"更新數量失敗")}))}}},created(){this.getCart()}},N=s(1241);const Q=(0,N.A)(F,[["render",U]]);var T=Q},5432:function(t,e,s){t.exports=s.p+"img/loading-img.aeb4fba1.png"}}]);
//# sourceMappingURL=611.311d5d92.js.map