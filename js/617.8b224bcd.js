"use strict";(self["webpackChunkvue3_cart"]=self["webpackChunkvue3_cart"]||[]).push([[617],{6617:function(e,s,a){a.r(s),a.d(s,{default:function(){return j}});var t=a(6768),l=a(4232),r=a(5130);const d={class:"container"},o={class:"m-100 row flex-row-reverse justify-content-center"},i={class:"col-md-4"},c={class:"border p-4 mb-4"},n=["src"],m={class:"w-100"},u={class:"d-flex justify-content-between"},b={class:"mb-0 fw-bold"},h={class:"border-0 align-middle"},p={class:"mb-0 fw-bold"},f={class:"d-flex justify-content-between mt-4"},k={class:"mb-0 h4 fw-bold"},L={class:"col-md-6"},v={class:"mb-0"},g={class:"mb-2"},x={class:"mb-2"},w={class:"mb-2"},y={class:"mb-2"},V={class:"text-end"},$=["disabled"];function C(e,s,a,C,F,_){const I=(0,t.g2)("useField"),U=(0,t.g2)("ErrorMsg"),j=(0,t.g2)("useForm");return(0,t.uX)(),(0,t.CE)("div",d,[s[12]||(s[12]=(0,t.Lk)("div",{class:"row justify-content-center"},[(0,t.Lk)("div",{class:"col-md-10"},[(0,t.Lk)("h3",{class:"fw-bold mb-4 pt-3"})])],-1)),(0,t.Lk)("div",o,[(0,t.Lk)("div",i,[(0,t.Lk)("div",c,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.cart.carts,(s=>((0,t.uX)(),(0,t.CE)("div",{class:"d-flex",key:s.id},[(0,t.Lk)("img",{src:s.product.imageUrl,alt:"",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,n),(0,t.Lk)("div",m,[(0,t.Lk)("div",u,[(0,t.Lk)("p",b,(0,l.v_)(s.product.title),1),(0,t.Lk)("td",h," NT$"+(0,l.v_)(e.$filters.currency(s.final_total)),1)]),(0,t.Lk)("p",p,"x "+(0,l.v_)(s.qty),1)])])))),128)),s[6]||(s[6]=(0,t.Lk)("table",{class:"table mt-4 border-top border-bottom text-muted"},[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",{scope:"row",class:"border-0 px-0 pt-3 pb-4 font-weight-normal"},"付款方式"),(0,t.Lk)("td",{class:"text-end border-0 px-0 pt-3 pb-4"},"現金結帳")])])],-1)),(0,t.Lk)("div",f,[s[5]||(s[5]=(0,t.Lk)("p",{class:"mb-0 h4 fw-bold"},"總價",-1)),(0,t.Lk)("p",k,"NT$"+(0,l.v_)(F.cart.final_total),1)])])]),(0,t.Lk)("div",L,[(0,t.bF)(j,{onSubmit:_.createOrder},{default:(0,t.k6)((({errors:e})=>[(0,t.Lk)("div",v,[s[7]||(s[7]=(0,t.Lk)("label",{for:"email",class:"text-muted mb-0"},"Email",-1)),(0,t.bF)(I,{id:"email",name:"email",type:"email",class:(0,l.C4)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入電子信箱",rules:"email|required",modelValue:F.form.user.email,"onUpdate:modelValue":s[0]||(s[0]=e=>F.form.user.email=e)},null,8,["class","modelValue"]),(0,t.bF)(U,{name:"email",class:"invalid-feedback"})]),(0,t.Lk)("div",g,[s[8]||(s[8]=(0,t.Lk)("label",{for:"name",class:"text-muted mb-0"},"收件人姓名",-1)),(0,t.bF)(I,{id:"name",name:"name",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:F.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=e=>F.form.user.name=e)},null,8,["class","modelValue"]),(0,t.bF)(U,{name:"姓名",class:"invalid-feedback"})]),(0,t.Lk)("div",x,[s[9]||(s[9]=(0,t.Lk)("label",{for:"tel",class:"text-muted mb-0"},"收件人電話",-1)),(0,t.bF)(I,{type:"tel",name:"電話",class:(0,l.C4)(["form-control",{"is-invalid":e["電話"]}]),id:"tel",placeholder:"請輸入電話",rules:"required",modelValue:F.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=e=>F.form.user.tel=e)},null,8,["class","modelValue"]),(0,t.bF)(U,{name:"電話",class:"invalid-feedback"})]),(0,t.Lk)("div",w,[s[10]||(s[10]=(0,t.Lk)("label",{for:"address",class:"text-muted mb-0"},"收件人地址",-1)),(0,t.bF)(I,{type:"text",name:"地址",class:(0,l.C4)(["form-control",{"is-invalid":e["地址"]}]),id:"address",placeholder:"請輸入地址",rules:"required",modelValue:F.form.user.address,"onUpdate:modelValue":s[3]||(s[3]=e=>F.form.user.address=e)},null,8,["class","modelValue"]),(0,t.bF)(U,{name:"地址",class:"invalid-feedback"})]),(0,t.Lk)("div",y,[s[11]||(s[11]=(0,t.Lk)("label",{for:"message",class:"text-muted mb-0"},"留言",-1)),(0,t.bo)((0,t.Lk)("textarea",{class:"form-control",rows:"3",id:"message",placeholder:"message ... ","onUpdate:modelValue":s[4]||(s[4]=e=>F.form.message=e)},null,512),[[r.Jo,F.form.message]])]),(0,t.Lk)("div",V,[(0,t.Lk)("button",{class:"btn btn-danger",disabled:F.isLoading},"送出訂單",8,$)])])),_:1},8,["onSubmit"])])])])}a(4114);var F=a(1600),_={name:"UserCheckout",data(){return{cart:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},orderId:"",isLoading:!1}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/api/andy1234-api/cart";this.isLoading=!0,this.$http.get(e).then((e=>{this.cart=e.data.data,this.isLoading=!1})).catch((e=>{console.error("獲取購物車失敗:",e),this.isLoading=!1}))},createOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/andy1234-api/order",s=this.form;this.$http.post(e,{data:s}).then((e=>{if(e.data.success){const s=e.data.orderId;this.$httpMessageState(e,"訂單創建成功"),F.A.emit("update-cart"),this.$router.push({path:`/checkout/${s}`})}else this.$httpMessageState(e,"訂單創建失敗"),console.error("建立訂單失敗:",e.data.message);this.isLoading=!1})).catch((e=>{this.isLoading=!1,console.error("建立訂單失敗:",e),this.$httpMessageState({success:!1},"訂單創建失敗")}))},getOrder(){if(!this.orderId)return;const e=`https://vue3-course-api.hexschool.io/api/andy1234-api/order/${this.orderId}`;this.$http.get(e).then((e=>{e.data.success&&(this.order=e.data.order)})).catch((e=>{console.error("獲取訂單失敗:",e)}))}},created(){this.orderId=this.$route.params.orderId,this.getCart(),this.getOrder()}},I=a(1241);const U=(0,I.A)(_,[["render",C]]);var j=U}}]);
//# sourceMappingURL=617.8b224bcd.js.map