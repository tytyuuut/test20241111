{"version":3,"file":"js/617.8b224bcd.js","mappings":"yMACOA,MAAM,a,GAMJA,MAAM,qD,GACJA,MAAM,Y,GACJA,MAAM,mB,EATnB,Q,GAYiBA,MAAM,S,GACJA,MAAM,kC,GACNA,MAAM,gB,GACLA,MAAM,yB,GAITA,MAAM,gB,GAeRA,MAAM,uC,GAENA,MAAM,mB,GAIVA,MAAM,Y,GAEFA,MAAM,Q,GAKNA,MAAM,Q,GAKNA,MAAM,Q,GAKNA,MAAM,Q,GAKNA,MAAM,Q,GAINA,MAAM,Y,EAlErB,a,oHACEC,EAAAA,EAAAA,IAuEM,MAvENC,EAuEM,gBAtEJC,EAAAA,EAAAA,IAIM,OAJDH,MAAM,8BAA4B,EACrCG,EAAAA,EAAAA,IAEM,OAFDH,MAAM,aAAW,EACpBG,EAAAA,EAAAA,IAAmC,MAA/BH,MAAM,0BAAmB,KAGjCG,EAAAA,EAAAA,IAgEM,MAhENC,EAgEM,EA/DJD,EAAAA,EAAAA,IA+BM,MA/BNE,EA+BM,EA9BJF,EAAAA,EAAAA,IA6BM,MA7BNG,EA6BM,gBA5BJL,EAAAA,EAAAA,IAWMM,EAAAA,GAAA,MArBhBC,EAAAA,EAAAA,IAU6CC,EAAAC,KAAKC,OAAbC,K,WAA3BX,EAAAA,EAAAA,IAWM,OAXDD,MAAM,SAAqCa,IAAKD,EAAKE,I,EACxDX,EAAAA,EAAAA,IAA2G,OAArGY,IAAKH,EAAKI,QAAQC,SAAUC,IAAI,GAAGlB,MAAM,OAAOmB,MAAA,mD,OAXlEC,IAYYjB,EAAAA,EAAAA,IAQM,MARNkB,EAQM,EAPJlB,EAAAA,EAAAA,IAKM,MALNmB,EAKM,EAJJnB,EAAAA,EAAAA,IAAoD,IAApDoB,GAAoDC,EAAAA,EAAAA,IAAzBZ,EAAKI,QAAQS,OAAK,IAC7CtB,EAAAA,EAAAA,IAEK,KAFLuB,EAAkC,QAC7BF,EAAAA,EAAAA,IAAGG,EAAAC,SAASC,SAASjB,EAAKkB,cAAW,MAG5C3B,EAAAA,EAAAA,IAA4C,IAA5C4B,EAAwB,MAAEP,EAAAA,EAAAA,IAAGZ,EAAKoB,KAAG,U,mBAGzC7B,EAAAA,EAAAA,IAWQ,SAXDH,MAAM,kDAAgD,EAC3DG,EAAAA,EAAAA,IASQ,eAJNA,EAAAA,EAAAA,IAGK,YAFHA,EAAAA,EAAAA,IAA4E,MAAxE8B,MAAM,MAAMjC,MAAM,8CAA6C,SACnEG,EAAAA,EAAAA,IAAsD,MAAlDH,MAAM,oCAAmC,cAAI,KAIvDG,EAAAA,EAAAA,IAGM,MAHN+B,EAGM,cAFJ/B,EAAAA,EAAAA,IAAiC,KAA9BH,MAAM,mBAAkB,MAAE,KAC7BG,EAAAA,EAAAA,IAAwD,IAAxDgC,EAA2B,OAAGX,EAAAA,EAAAA,IAAGf,EAAAC,KAAKoB,aAAW,UAIvD3B,EAAAA,EAAAA,IA8BM,MA9BNiC,EA8BM,EA7BJC,EAAAA,EAAAA,IA4BUC,EAAA,CA5BoBC,SAAQC,EAAAC,aAAW,CAzCzDC,SAAAC,EAAAA,EAAAA,KA0CU,EADiBC,YAAM,EACvBzC,EAAAA,EAAAA,IAIM,MAJN0C,EAIM,cAHJ1C,EAAAA,EAAAA,IAAwD,SAAjD2C,IAAI,QAAQ9C,MAAM,mBAAkB,SAAK,KAChDqC,EAAAA,EAAAA,IAAgMU,EAAA,CAAtLjC,GAAG,QAAQkC,KAAK,QAAQC,KAAK,QAAQjD,OA5C3DkD,EAAAA,EAAAA,IAAA,CA4CiE,eAAc,cAAyBN,EAAO,YAAWO,YAAY,UAAUC,MAAM,iBA5CtJC,WA4CgL5C,EAAA6C,KAAKC,KAAKC,MA5C1L,sBAAAC,EAAA,KAAAA,EAAA,GAAAC,GA4CgLjD,EAAA6C,KAAKC,KAAKC,MAAKE,I,gCACnLrB,EAAAA,EAAAA,IAA2DsB,EAAA,CAAjDX,KAAK,QAAQhD,MAAM,wBAE/BG,EAAAA,EAAAA,IAIM,MAJNyD,EAIM,cAHJzD,EAAAA,EAAAA,IAAuD,SAAhD2C,IAAI,OAAO9C,MAAM,mBAAkB,SAAK,KAC/CqC,EAAAA,EAAAA,IAAiLU,EAAA,CAAvKjC,GAAG,OAAOkC,KAAK,OAAOC,KAAK,OAAOjD,OAjDxDkD,EAAAA,EAAAA,IAAA,CAiD8D,eAAc,cAAyBN,EAAO,SAAQO,YAAY,QAAQC,MAAM,WAjD9IC,WAiDkK5C,EAAA6C,KAAKC,KAAKP,KAjD5K,sBAAAS,EAAA,KAAAA,EAAA,GAAAC,GAiDkKjD,EAAA6C,KAAKC,KAAKP,KAAIU,I,gCACpKrB,EAAAA,EAAAA,IAAwDsB,EAAA,CAA9CX,KAAK,KAAKhD,MAAM,wBAE5BG,EAAAA,EAAAA,IAIM,MAJN0D,EAIM,cAHJ1D,EAAAA,EAAAA,IAAsD,SAA/C2C,IAAI,MAAM9C,MAAM,mBAAkB,SAAK,KAC9CqC,EAAAA,EAAAA,IAA4KU,EAAA,CAAlKE,KAAK,MAAMD,KAAK,KAAKhD,OAtD3CkD,EAAAA,EAAAA,IAAA,CAsDiD,eAAc,cAAyBN,EAAO,SAAQ9B,GAAG,MAAMqC,YAAY,QAAQC,MAAM,WAtD1IC,WAsD8J5C,EAAA6C,KAAKC,KAAKO,IAtDxK,sBAAAL,EAAA,KAAAA,EAAA,GAAAC,GAsD8JjD,EAAA6C,KAAKC,KAAKO,IAAGJ,I,gCAC/JrB,EAAAA,EAAAA,IAAwDsB,EAAA,CAA9CX,KAAK,KAAKhD,MAAM,wBAE5BG,EAAAA,EAAAA,IAIM,MAJN4D,EAIM,gBAHJ5D,EAAAA,EAAAA,IAA0D,SAAnD2C,IAAI,UAAU9C,MAAM,mBAAkB,SAAK,KAClDqC,EAAAA,EAAAA,IAAqLU,EAAA,CAA3KE,KAAK,OAAOD,KAAK,KAAKhD,OA3D5CkD,EAAAA,EAAAA,IAAA,CA2DkD,eAAc,cAAyBN,EAAO,SAAQ9B,GAAG,UAAUqC,YAAY,QAAQC,MAAM,WA3D/IC,WA2DmK5C,EAAA6C,KAAKC,KAAKS,QA3D7K,sBAAAP,EAAA,KAAAA,EAAA,GAAAC,GA2DmKjD,EAAA6C,KAAKC,KAAKS,QAAON,I,gCACxKrB,EAAAA,EAAAA,IAAwDsB,EAAA,CAA9CX,KAAK,KAAKhD,MAAM,wBAE5BG,EAAAA,EAAAA,IAGM,MAHN8D,EAGM,gBAFJ9D,EAAAA,EAAAA,IAAuD,SAAhD2C,IAAI,UAAU9C,MAAM,mBAAkB,MAAE,cAC/CG,EAAAA,EAAAA,IAAkH,YAAxGH,MAAM,eAAekE,KAAK,IAAIpD,GAAG,UAAUqC,YAAY,eAhE7E,sBAAAM,EAAA,KAAAA,EAAA,GAAAC,GAgEqGjD,EAAA6C,KAAKa,QAAOT,I,iBAAZjD,EAAA6C,KAAKa,cAEhGhE,EAAAA,EAAAA,IAEM,MAFNiE,EAEM,EADJjE,EAAAA,EAAAA,IAAkE,UAA1DH,MAAM,iBAAkBqE,SAAU5D,EAAA6D,WAAW,OAAI,EAnErEC,QAAAC,EAAA,G,4CA8EA,GACExB,KAAM,eACNyB,IAAAA,GACE,MAAO,CACL/D,KAAM,CAAC,EACP4C,KAAM,CACJC,KAAM,CACJP,KAAM,GACNQ,MAAO,GACPM,IAAK,GACLE,QAAS,IAEXG,QAAS,IAEXO,QAAS,GACTJ,WAAW,EAEf,EACAK,QAAS,CACPC,OAAAA,GACE,MAAMC,EAAM,6DACZC,KAAKR,WAAY,EACjBQ,KAAKC,MAAMC,IAAIH,GAAKI,MAAMC,IACxBJ,KAAKpE,KAAOwE,EAAST,KAAKA,KAC1BK,KAAKR,WAAY,CAAK,IACrBa,OAAOC,IACRC,QAAQD,MAAM,WAAYA,GAC1BN,KAAKR,WAAY,CAAK,GAE1B,EACA7B,WAAAA,GACEqC,KAAKR,WAAY,EACjB,MAAMO,EAAM,8DACNS,EAAQR,KAAKxB,KACnBwB,KAAKC,MAAMQ,KAAKV,EAAK,CAAEJ,KAAMa,IAC1BL,MAAMC,IACL,GAAIA,EAAST,KAAKe,QAAS,CACzB,MAAMd,EAAUQ,EAAST,KAAKC,QAC9BI,KAAKW,kBAAkBP,EAAU,UACjCQ,EAAAA,EAAQC,KAAK,eACbb,KAAKc,QAAQC,KAAK,CAAEC,KAAM,aAAapB,KACzC,MACEI,KAAKW,kBAAkBP,EAAU,UACjCG,QAAQD,MAAM,UAAWF,EAAST,KAAKN,SAEzCW,KAAKR,WAAY,CAAK,IAEvBa,OAAOC,IACNN,KAAKR,WAAY,EACjBe,QAAQD,MAAM,UAAWA,GACzBN,KAAKW,kBAAkB,CAAED,SAAS,GAAS,SAAS,GAE1D,EACAO,QAAAA,GACE,IAAKjB,KAAKJ,QAAS,OACnB,MAAMG,EAAM,+DAAmEC,KAAKJ,UACpFI,KAAKC,MAAMC,IAAIH,GAAKI,MAAMe,IACpBA,EAAIvB,KAAKe,UACXV,KAAKQ,MAAQU,EAAIvB,KAAKa,MACxB,IACCH,OAAOC,IACRC,QAAQD,MAAM,UAAWA,EAAM,GAEnC,GAEFa,OAAAA,GACEnB,KAAKJ,QAAUI,KAAKoB,OAAOC,OAAOzB,QAClCI,KAAKF,UACLE,KAAKiB,UACP,G,UC5IF,MAAMK,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://vue3-cart/./src/views/front/checkout.vue","webpack://vue3-cart/./src/views/front/checkout.vue?3fe2"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"row justify-content-center\">\n      <div class=\"col-md-10\">\n        <h3 class=\"fw-bold mb-4 pt-3\"></h3>\n      </div>\n    </div>\n    <div class=\"m-100 row flex-row-reverse justify-content-center\">\n      <div class=\"col-md-4\">\n        <div class=\"border p-4 mb-4\">\n          <div class=\"d-flex\" v-for=\"item in cart.carts\" :key=\"item.id\">\n            <img :src=\"item.product.imageUrl\" alt=\"\" class=\"me-2\" style=\"width: 48px; height: 48px; object-fit: cover\">\n            <div class=\"w-100\">\n              <div class=\"d-flex justify-content-between\">\n                <p class=\"mb-0 fw-bold\">{{ item.product.title }}</p>\n                <td class=\"border-0 align-middle\">\n                  NT${{ $filters.currency(item.final_total) }}\n                </td>\n              </div>\n              <p class=\"mb-0 fw-bold\">x {{ item.qty }}</p>\n            </div>\n          </div>\n          <table class=\"table mt-4 border-top border-bottom text-muted\">\n            <tbody>\n              <!-- <tr>\n                <th scope=\"row\" class=\"border-0 px-0 pt-4 font-weight-normal\">Subtotal</th>\n                <td class=\"text-end border-0 px-0 pt-4\">NT${{ cart.final_total }}</td>\n              </tr> -->\n              <tr>\n                <th scope=\"row\" class=\"border-0 px-0 pt-3 pb-4 font-weight-normal\">付款方式</th>\n                <td class=\"text-end border-0 px-0 pt-3 pb-4\">現金結帳</td>\n              </tr>\n            </tbody>\n          </table>\n          <div class=\"d-flex justify-content-between mt-4\">\n            <p class=\"mb-0 h4 fw-bold\">總價</p>\n            <p class=\"mb-0 h4 fw-bold\">NT${{ cart.final_total }}</p>\n          </div>\n        </div>\n      </div>\n      <div class=\"col-md-6\">\n        <useForm v-slot=\"{ errors }\" @submit=\"createOrder\">\n          <div class=\"mb-0\">\n            <label for=\"email\" class=\"text-muted mb-0\">Email</label>\n            <useField id=\"email\" name=\"email\" type=\"email\" class=\"form-control\" :class=\"{ 'is-invalid': errors['email']}\" placeholder=\"請輸入電子信箱\" rules=\"email|required\" v-model=\"form.user.email\"></useField>\n            <ErrorMsg name=\"email\" class=\"invalid-feedback\"></ErrorMsg>\n          </div>\n          <div class=\"mb-2\">\n            <label for=\"name\" class=\"text-muted mb-0\">收件人姓名</label>\n            <useField id=\"name\" name=\"name\" type=\"text\" class=\"form-control\" :class=\"{ 'is-invalid': errors['姓名']}\" placeholder=\"請輸入姓名\" rules=\"required\" v-model=\"form.user.name\"></useField>\n            <ErrorMsg name=\"姓名\" class=\"invalid-feedback\"></ErrorMsg>\n          </div>\n          <div class=\"mb-2\">\n            <label for=\"tel\" class=\"text-muted mb-0\">收件人電話</label>\n            <useField type=\"tel\" name=\"電話\" class=\"form-control\" :class=\"{ 'is-invalid': errors['電話']}\" id=\"tel\" placeholder=\"請輸入電話\" rules=\"required\" v-model=\"form.user.tel\"></useField>\n            <ErrorMsg name=\"電話\" class=\"invalid-feedback\"></ErrorMsg>\n          </div>\n          <div class=\"mb-2\">\n            <label for=\"address\" class=\"text-muted mb-0\">收件人地址</label>\n            <useField type=\"text\" name=\"地址\" class=\"form-control\" :class=\"{ 'is-invalid': errors['地址']}\" id=\"address\" placeholder=\"請輸入地址\" rules=\"required\" v-model=\"form.user.address\"></useField>\n            <ErrorMsg name=\"地址\" class=\"invalid-feedback\"></ErrorMsg>\n          </div>\n          <div class=\"mb-2\">\n            <label for=\"message\" class=\"text-muted mb-0\">留言</label>\n            <textarea class=\"form-control\" rows=\"3\" id=\"message\" placeholder=\"message ... \" v-model=\"form.message\"></textarea>\n          </div>\n          <div class=\"text-end\">\n            <button class=\"btn btn-danger\" :disabled=\"isLoading\">送出訂單</button>\n          </div>\n        </useForm>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport emitter from '@/methods/emitter';\n\nexport default {\n  name: \"UserCheckout\",\n  data() {\n    return {\n      cart: {},\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: '',\n        },\n        message: '',\n      },\n      orderId: '',\n      isLoading: false,\n    };\n  },\n  methods: {\n    getCart() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      this.isLoading = true;\n      this.$http.get(url).then((response) => {\n        this.cart = response.data.data;\n        this.isLoading = false;\n      }).catch((error) => {\n        console.error('獲取購物車失敗:', error);\n        this.isLoading = false;\n      });\n    },\n    createOrder() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order`;\n      const order = this.form;\n      this.$http.post(url, { data: order })\n        .then((response) => {\n          if (response.data.success) {\n            const orderId = response.data.orderId; // 假設 API 返回的 ID 是 `response.data.orderId`\n            this.$httpMessageState(response, '訂單創建成功');\n            emitter.emit('update-cart'); // 發送更新事件，讓 cart.vue 更新數量\n            this.$router.push({ path: `/checkout/${orderId}` }); // 導航到訂單確認頁面\n          } else {\n            this.$httpMessageState(response, '訂單創建失敗');\n            console.error('建立訂單失敗:', response.data.message);\n          }\n          this.isLoading = false;\n        })\n        .catch((error) => {\n          this.isLoading = false;\n          console.error('建立訂單失敗:', error);\n          this.$httpMessageState({ success: false }, '訂單創建失敗');\n        });\n    },\n    getOrder() {\n      if (!this.orderId) return; // 如果沒有 orderId，不執行\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order/${this.orderId}`;\n      this.$http.get(url).then((res) => {\n        if (res.data.success) {\n          this.order = res.data.order;\n        }\n      }).catch((error) => {\n        console.error('獲取訂單失敗:', error);\n      });\n    },\n  },\n  created() {\n    this.orderId = this.$route.params.orderId;\n    this.getCart();\n    this.getOrder();\n  }\n}\n</script>\n\n<style>\n.m-100 {\n  padding-top: 65px;\n  padding-bottom: 250px;\n}\n</style>","import { render } from \"./checkout.vue?vue&type=template&id=391981c1\"\nimport script from \"./checkout.vue?vue&type=script&lang=js\"\nexport * from \"./checkout.vue?vue&type=script&lang=js\"\n\nimport \"./checkout.vue?vue&type=style&index=0&id=391981c1&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_Fragment","_renderList","$data","cart","carts","item","key","id","src","product","imageUrl","alt","style","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_toDisplayString","title","_hoisted_9","_ctx","$filters","currency","final_total","_hoisted_10","qty","scope","_hoisted_11","_hoisted_12","_hoisted_13","_createVNode","_component_useForm","onSubmit","$options","createOrder","default","_withCtx","errors","_hoisted_14","for","_component_useField","name","type","_normalizeClass","placeholder","rules","modelValue","form","user","email","_cache","$event","_component_ErrorMsg","_hoisted_15","_hoisted_16","tel","_hoisted_17","address","_hoisted_18","rows","message","_hoisted_19","disabled","isLoading","_hoisted_20","_","data","orderId","methods","getCart","url","this","$http","get","then","response","catch","error","console","order","post","success","$httpMessageState","emitter","emit","$router","push","path","getOrder","res","created","$route","params","__exports__","render"],"sourceRoot":""}